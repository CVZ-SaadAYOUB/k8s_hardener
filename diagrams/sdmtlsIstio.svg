<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="705px" preserveAspectRatio="none" style="width:1418px;height:705px;background:#FFFFFF;" version="1.1" viewBox="0 0 1418 705" width="1418px" zoomAndPan="magnify"><defs/><g><g><title>User</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="33.9551" y="285.2266"/></g><g><title>K8sHardenerCLI</title><rect fill="#FFFFFF" height="478.7969" style="stroke:#181818;stroke-width:1;" width="10" x="668.2886" y="127.5625"/></g><g><title>MtlsEnforcerModule</title><rect fill="#FFFFFF" height="449.6641" style="stroke:#181818;stroke-width:1;" width="10" x="920.8594" y="156.6953"/></g><g><title>KubernetesAPIServer</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="1325.9517" y="372.625"/></g><rect fill="none" height="119.3359" style="stroke:#000000;stroke-width:1.5;" width="1002.2065" x="10" y="458.8906"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="543.0625" width="8" x="34.9551" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="38" x2="38" y1="81.2969" y2="624.3594"/></g><g><title>K8sHardenerCLI</title><rect fill="#000000" fill-opacity="0.00000" height="543.0625" width="8" x="669.2886" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="672.9434" x2="672.9434" y1="81.2969" y2="624.3594"/></g><g><title>MtlsEnforcerModule</title><rect fill="#000000" fill-opacity="0.00000" height="543.0625" width="8" x="921.8594" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="925.5122" x2="925.5122" y1="81.2969" y2="624.3594"/></g><g><title>KubernetesAPIServer</title><rect fill="#000000" fill-opacity="0.00000" height="543.0625" width="8" x="1326.9517" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1330.8262" x2="1330.8262" y1="81.2969" y2="624.3594"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="20" y="77.9951">User</text><ellipse cx="38.9551" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38.9551,21.5 L38.9551,48.5 M25.9551,29.5 L51.9551,29.5 M38.9551,48.5 L25.9551,63.5 M38.9551,48.5 L51.9551,63.5" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="20" y="636.3545">User</text><ellipse cx="38.9551" cy="648.1563" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38.9551,656.1563 L38.9551,683.1563 M25.9551,664.1563 L51.9551,664.1563 M38.9551,683.1563 L25.9551,698.1563 M38.9551,683.1563 L51.9551,698.1563" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="K8sHardenerCLI"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126.6904" x="609.9434" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112.6904" x="616.9434" y="69.9951">K8sHardenerCLI</text></g><g class="participant participant-tail" data-participant="K8sHardenerCLI"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126.6904" x="609.9434" y="623.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112.6904" x="616.9434" y="643.3545">K8sHardenerCLI</text></g><g class="participant participant-head" data-participant="MtlsEnforcerModule"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152.6943" x="849.5122" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138.6943" x="856.5122" y="69.9951">MtlsEnforcerModule</text></g><g class="participant participant-tail" data-participant="MtlsEnforcerModule"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152.6943" x="849.5122" y="623.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138.6943" x="856.5122" y="643.3545">MtlsEnforcerModule</text></g><g class="participant participant-head" data-participant="KubernetesAPIServer"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="162.251" x="1249.8262" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148.251" x="1256.8262" y="69.9951">KubernetesAPIServer</text></g><g class="participant participant-tail" data-participant="KubernetesAPIServer"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="162.251" x="1249.8262" y="623.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148.251" x="1256.8262" y="643.3545">KubernetesAPIServer</text></g><g><title>User</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="33.9551" y="285.2266"/></g><g><title>K8sHardenerCLI</title><rect fill="#FFFFFF" height="478.7969" style="stroke:#181818;stroke-width:1;" width="10" x="668.2886" y="127.5625"/></g><g><title>MtlsEnforcerModule</title><rect fill="#FFFFFF" height="449.6641" style="stroke:#181818;stroke-width:1;" width="10" x="920.8594" y="156.6953"/></g><g><title>KubernetesAPIServer</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="1325.9517" y="372.625"/></g><g class="message" data-participant-1="User" data-participant-2="K8sHardenerCLI"><polygon fill="#181818" points="656.2886,123.5625,666.2886,127.5625,656.2886,131.5625,660.2886,127.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="38.9551" x2="662.2886" y1="127.5625" y2="127.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.355" x="45.9551" y="107.3638">Navigate menus</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="610.3335" x="45.9551" y="122.4966">"Istio and Zero Trust" &#8594; "mTLS Enforcement Manager" &#8594; "Enforce STRICT mTLS (Mesh-wide)"</text></g><g class="message" data-participant-1="K8sHardenerCLI" data-participant-2="MtlsEnforcerModule"><polygon fill="#181818" points="908.8594,152.6953,918.8594,156.6953,908.8594,160.6953,912.8594,156.6953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="678.2886" x2="914.8594" y1="156.6953" y2="156.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223.5708" x="685.2886" y="151.6294">enforce_strict_mtls(confirm=True)</text></g><g class="message" data-participant-1="MtlsEnforcerModule" data-participant-2="MtlsEnforcerModule"><line style="stroke:#181818;stroke-width:1;" x1="930.8594" x2="972.8594" y1="185.8281" y2="185.8281"/><line style="stroke:#181818;stroke-width:1;" x1="972.8594" x2="972.8594" y1="185.8281" y2="198.8281"/><line style="stroke:#181818;stroke-width:1;" x1="931.8594" x2="972.8594" y1="198.8281" y2="198.8281"/><polygon fill="#181818" points="941.8594,194.8281,931.8594,198.8281,941.8594,202.8281,937.8594,198.8281" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264.2783" x="937.8594" y="180.7622">set_mtls_mode("STRICT", confirm=True)</text></g><g class="message" data-participant-1="MtlsEnforcerModule" data-participant-2="MtlsEnforcerModule"><line style="stroke:#181818;stroke-width:1;" x1="930.8594" x2="972.8594" y1="227.9609" y2="227.9609"/><line style="stroke:#181818;stroke-width:1;" x1="972.8594" x2="972.8594" y1="227.9609" y2="240.9609"/><line style="stroke:#181818;stroke-width:1;" x1="931.8594" x2="972.8594" y1="240.9609" y2="240.9609"/><polygon fill="#181818" points="941.8594,236.9609,931.8594,240.9609,941.8594,244.9609,937.8594,240.9609" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="316.1514" x="937.8594" y="222.895">yaml = _get_peerauthentication_yaml("STRICT")</text></g><g class="message" data-participant-1="MtlsEnforcerModule" data-participant-2="User"><polygon fill="#181818" points="54.9551,281.2266,44.9551,285.2266,54.9551,289.2266,50.9551,285.2266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="48.9551" x2="919.8594" y1="285.2266" y2="285.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206.8447" x="60.9551" y="265.0278">"Displaying STRICT mTLS policy</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274.1108" x="60.9551" y="280.1606">Are you sure you want to apply? (yes/no)"</text></g><g class="message" data-participant-1="User" data-participant-2="MtlsEnforcerModule"><polygon fill="#181818" points="908.8594,310.3594,918.8594,314.3594,908.8594,318.3594,912.8594,314.3594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="38.9551" x2="914.8594" y1="314.3594" y2="314.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22.4644" x="45.9551" y="309.2935">yes</text></g><g class="message" data-participant-1="MtlsEnforcerModule" data-participant-2="User"><polygon fill="#181818" points="49.9551,339.4922,39.9551,343.4922,49.9551,347.4922,45.9551,343.4922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.9551" x2="919.8594" y1="343.4922" y2="343.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252.3066" x="55.9551" y="338.4263">"Applying PeerAuthentication policy..."</text></g><g class="message" data-participant-1="MtlsEnforcerModule" data-participant-2="KubernetesAPIServer"><polygon fill="#181818" points="1313.9517,368.625,1323.9517,372.625,1313.9517,376.625,1317.9517,372.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="930.8594" x2="1319.9517" y1="372.625" y2="372.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="376.0923" x="937.8594" y="367.5591">apply PeerAuthentication YAML (istio-system namespace)</text></g><g class="message" data-participant-1="KubernetesAPIServer" data-participant-2="MtlsEnforcerModule"><line style="stroke:#181818;stroke-width:1;" x1="931.8594" x2="941.8594" y1="401.7578" y2="397.7578"/><line style="stroke:#181818;stroke-width:1;" x1="931.8594" x2="941.8594" y1="401.7578" y2="405.7578"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="930.8594" x2="1329.9517" y1="401.7578" y2="401.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.8535" x="947.8594" y="396.6919">apply status</text></g><g class="message" data-participant-1="MtlsEnforcerModule" data-participant-2="MtlsEnforcerModule"><line style="stroke:#181818;stroke-width:1;" x1="930.8594" x2="972.8594" y1="430.8906" y2="430.8906"/><line style="stroke:#181818;stroke-width:1;" x1="972.8594" x2="972.8594" y1="430.8906" y2="443.8906"/><line style="stroke:#181818;stroke-width:1;" x1="931.8594" x2="972.8594" y1="443.8906" y2="443.8906"/><polygon fill="#181818" points="941.8594,439.8906,931.8594,443.8906,941.8594,447.8906,937.8594,443.8906" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.0464" x="937.8594" y="425.8247">check apply status</text></g><path d="M10,458.8906 L74.4429,458.8906 L74.4429,466.0234 L64.4429,476.0234 L10,476.0234 L10,458.8906" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="119.3359" style="stroke:#000000;stroke-width:1.5;" width="1002.2065" x="10" y="458.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="471.9575">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="59.4043" x="89.4429" y="471.1011">[Success]</text><g class="message" data-participant-1="MtlsEnforcerModule" data-participant-2="User"><polygon fill="#181818" points="49.9551,493.1563,39.9551,497.1563,49.9551,501.1563,45.9551,497.1563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.9551" x2="919.8594" y1="497.1563" y2="497.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="299.8442" x="55.9551" y="492.0903">"Mesh-wide mTLS set to STRICT successfully."</text></g><g class="message" data-participant-1="MtlsEnforcerModule" data-participant-2="User"><polygon fill="#181818" points="49.9551,522.2891,39.9551,526.2891,49.9551,530.2891,45.9551,526.2891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.9551" x2="919.8594" y1="526.2891" y2="526.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="349.7622" x="55.9551" y="521.2231">"It may take some time for the policy to propagate..."</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="10" x2="1012.2065" y1="535.2891" y2="535.2891"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="53.249" x="15" y="545.4995">[Failure]</text><g class="message" data-participant-1="MtlsEnforcerModule" data-participant-2="User"><polygon fill="#181818" points="49.9551,566.2266,39.9551,570.2266,49.9551,574.2266,45.9551,570.2266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.9551" x2="919.8594" y1="570.2266" y2="570.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.0166" x="55.9551" y="565.1606">"Error applying mTLS policy!"</text></g><g class="message" data-participant-1="MtlsEnforcerModule" data-participant-2="K8sHardenerCLI"><line style="stroke:#181818;stroke-width:1;" x1="674.2886" x2="684.2886" y1="606.3594" y2="602.3594"/><line style="stroke:#181818;stroke-width:1;" x1="674.2886" x2="684.2886" y1="606.3594" y2="610.3594"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="673.2886" x2="924.8594" y1="606.3594" y2="606.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.4722" x="690.2886" y="601.2935">enforce_strict_mtls() complete</text></g><!--SRC=[ZLJBRjim4BphAxOwoK3jNWi3QM6a2IBKBeBQFRG8O6ofjKs4Bt0f1_g1Va0_iLzIqb9Jov6Jw2288ZaxEpCaYc0zV6FocKCVf90EJO3Fx_a6VKM6_EMyx4qjWk8hix5Ua5_OgbRKtrd_96ye4CzkooNvVKJE4ZwCFvp0Jk4BxkKM0u4cK_EToKiEqWAQ2dwGjx3oDOSS_lpw3RbUpPVG5OxB8n4qk2NVJNSpi5nzBIzNS5XTB8XtumTPqIZFK0IvJxLEUilwuqJpQOjJe7Qyvk2b26iTbnJ2cetq-YBIfD7_0WCAPK__dIl4rAAljQseoDj-yhVGB_Pwl0QrWWjORoEk8_9OXrsKJmgCKfjrcdwiCZf7D1auXVoJPAUmaMRRqzbP9KLpPsQUeB4rSDrzFAH4X6YeSwhv24L3_CxOOpCEoMlZSOu_SLPHVyFpB6UfMk9u6zkTzThjg4uca_mCna1-fot_8RZliyKS2fbIE-Q60samg8aTYkD431sAWNz9Ws4HMW8SCDGzDGPFs-kp8NOaxllW6Qe0ore8OiuWFizA_NZ0sY34x2QxksnmYxAfbMgYtY-2bG4qDX3mde2j9WWolk9YY9ftpYLuvwt3T6qSR2J51DSeLGpTopMkl8zu-2yXH_5z4w5CDQnUikNqxXgw44Rnb6gdeX_79WtS1ySMzd3_0W00]--></g></svg>